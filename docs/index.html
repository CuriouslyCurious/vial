<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>vial: a micro micro-framework</title>
    <style type="text/css">
      body {
        margin: 40px auto;
        line-height: 1.6;
        font-size: 20px;
        color: #444;
        padding: 16px;
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica,
          Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
      }

      /* big logo */
      h1:first-of-type {
        font-size: 80px;
        margin-bottom: 0;
        margin-top: -20px;
        padding-top: 0;
      }
      h4:first-of-type {
        margin: 0;
        font-size: 20px;
        color: #aaa;
        margin-top: -10px;
        margin-bottom: 20px;
        font-weight: normal;
        font-style: italic;
      }
      img:first-of-type {
        margin-top: -25px;
        margin-right: 20px;
      }

      /* structure */
      nav {
        float: left;
        padding-top: 0;
      }
      main {
        margin: 0 auto;
        max-width: 800px;
      }

      nav.show-mobile {
        display: block;
      }

      /* responsive */
      @media (max-width: 1500px) {
        main {
          padding-left: 75px;
          float: left;
        }
        img:first-of-type {
          margin-top: -45px;
        }
        nav.show-mobile {
          display: block;
        }
      }

      @media (max-width: 1180px) {
        nav {
          display: none;
        }
        nav.show-mobile {
          display: block;
          font-size: 150%;
          margin-left: 200px;
          width: 100%;
        }
        nav.show-mobile h3 {
          font-size: 150%;
        }
        main {
          float: left;
        }
        #menu-toggle {
          display: block !important;
        }
      }

      /* regular stuff */
      a {
        color: black;
        text-decoration: none;
        border-bottom: 1px solid black;
      }
      a:visited {
        color: #666;
        text-decoration: none;
      }
      a:hover {
        border-bottom: none;
        color: fuchsia;
      }
      h1 {
        font-size: 2em;
      }
      h2 {
        font-size: 1.75em;
        margin-top: 75px;
      }
      h2:first-of-type {
        margin-top: 40px;
      }
      h2,
      h3 {
        border-bottom: 1px solid #ddd;
      }
      h1,
      h2,
      h3 {
        line-height: 1.2;
      }
      p {
        text-align: justify;
      }

      /* nav  */
      nav h3 {
        margin: 0;
        padding-bottom: 0;
        padding-left: 40px;
        font-size: 22px;
        border-bottom: none;
      }
      nav h3:not(:first-of-type) {
        margin-top: 40px;
      }
      nav h3 + ul {
        margin-top: 10px;
      }
      nav ul {
        list-style-type: none;
      }
      nav ul ul {
        list-style-type: disc;
      }

      main li code,
      main pre code:not(.sourceCode),
      main p code {
        background-color: #f7f7f7;
        padding: 5px;
      }

      /* pandoc styles */
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
      div.hanging-indent {
        margin-left: 1.5em;
        text-indent: -1.5em;
      }
      pre > code.sourceCode {
        white-space: pre;
        position: relative;
      }
      pre > code.sourceCode > span {
        display: inline-block;
        line-height: 1.25;
      }
      pre > code.sourceCode > span:empty {
        height: 1.2em;
      }
      code.sourceCode > span {
        color: inherit;
        text-decoration: inherit;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
        background-color: #f7f7f7;
        border-radius: 15px;
        padding: 20px;
        color: #444;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        pre > code.sourceCode {
          white-space: pre-wrap;
        }
        pre > code.sourceCode > span {
          text-indent: -5em;
          padding-left: 5em;
        }
      }
      pre.numberSource code {
        counter-reset: source-line 0;
      }
      pre.numberSource code > span {
        position: relative;
        left: -4em;
        counter-increment: source-line;
      }
      pre.numberSource code > span > a:first-child::before {
        content: counter(source-line);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      @media screen {
        pre > code.sourceCode > span > a:first-child::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        /* color: red; */
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        /* color: red; */
      } /* DataType */
      code span.dv {
        color: red;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #7100f5;
        /* font-weight: bold; */
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        /* color: black; */
        /* font-weight: bold; */
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: rgb(134, 0, 134);
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */

      /* hamburger */
      /* by Erik Terwan */

      #menu-toggle {
        display: none;
        position: absolute;
        top: 50px;
        right: 50px;
        z-index: 1;
        -webkit-user-select: none;
        user-select: none;
      }

      #menu-toggle input {
        display: block;
        width: 40px;
        height: 32px;
        position: absolute;
        top: -7px;
        left: -5px;
        cursor: pointer;
        opacity: 0; /* hide this */
        z-index: 2; /* and place it over the hamburger */
        -webkit-touch-callout: none;
      }

      #menu-toggle span {
        display: block;
        width: 33px;
        height: 4px;
        margin-bottom: 5px;
        position: relative;
        background: #cdcdcd;
        border-radius: 3px;
        z-index: 1;
        transform-origin: 4px 0px;
        transition: transform 0.5s cubic-bezier(0.77, 0.2, 0.05, 1),
          background 0.5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity 0.55s ease;
      }

      #menu-toggle span {
        opacity: 1;
        background: #232323;
      }

      #menu-toggle span:first-child {
        transform-origin: 0% 0%;
      }

      #menu-toggle span:nth-last-child(2) {
        transform-origin: 0% 100%;
      }

      #menu-toggle input:checked ~ span {
        opacity: 0.25;
      }
    </style>
  </head>
  <body>
    <div id="menu-toggle">
      <input type="checkbox" onclick="clickHamburger();" />
      <span></span>
      <span></span>
      <span></span>
    </div>
    <nav><h3 id="sections">Sections</h3>
<ul>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#routing">Routing</a>
<ul>
<li><a href="#http-methods">HTTP Methods</a></li>
<li><a href="#route-patterns">Route Patterns</a></li>
<li><a href="#actions">Actions</a></li>
<li><a href="#route-modules">Route Modules</a></li>
</ul></li>
<li><a href="#requests">Requests</a>
<ul>
<li><a href="#route-parameters">Route Parameters</a></li>
<li><a href="#query-parameters">Query Parameters</a></li>
<li><a href="#form-data">Form Data</a></li>
<li><a href="#request-headers">Request Headers</a></li>
<li><a href="#other-info">Other Info</a></li>
</ul></li>
<li><a href="#responses">Responses</a>
<ul>
<li><a href="#from-string">from String</a></li>
<li><a href="#from-file">from File</a></li>
<li><a href="#from-asset">from Asset</a></li>
<li><a href="#redirect">Redirect</a></li>
<li><a href="#status-codes">Status Codes</a></li>
<li><a href="#headers">Headers</a></li>
</ul></li>
<li><a href="#assets">Assets</a>
<ul>
<li><a href="#setting-asset-dir">Setting asset dir</a></li>
<li><a href="#%60asset::exists()%60"><code>asset::exists()</code></a></li>
<li><a href="#%60asset::path()%60"><code>asset::path()</code></a></li>
<li><a href="#bundling-assets">Bundling Assets</a></li>
</ul></li>
</ul>
<h3 id="bonus-features">Bonus Features</h3>
<ul>
<li><a href="#templates">Templates</a>
<ul>
<li><a href="#hatter">Hatter</a></li>
<li><a href="#horrorshow">Horrorshow</a></li>
<li><a href="#tera">Tera</a></li>
</ul></li>
<li><a href="#cookies">Cookies</a></li>
<li><a href="#sessions">Sessions</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#state">State</a></li>
<li><a href="#database">Database</a></li>
<li><a href="#markdown">Markdown</a></li>
</ul>
</nav>
    <main><p><img src="./img/drink-me.jpeg" alt="Drink Me." align="left" height="300" /></p>
<h1 id="vial">Vial</h1>
<h4 id="a-micro-micro-framework">~ a micro micro-framework ~</h4>
<p><strong>Vial</strong> is a small web “framework” for making small web “sites” in Rust. It includes just a handful of basic features for delivering old school, server-side rendered HTML: request routing, form data parsing, response building, and serving static file assets.</p>
<p>The goal is a small, lean core that compiles quickly and has as few dependencies as possible. Use it for HTML stuff: prototyping ideas, testing out concepts, or, perhaps, even writing tiny personal apps. Nothing serious though, got it?</p>
<p>This manual is an overview of <strong>Vial</strong>’s built-in features, as well as the few <em>optional</em> features you can enable. It also includes suggestions for some “common tasks”, like using a database to store information.</p>
<h2 id="hello-world">Hello World</h2>
<p>First, here’s the bare minimum:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb1-1"><a href="#cb1-1"></a><span class="pp">vial::routes!</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>    GET <span class="st">&quot;/&quot;</span> =&gt; |_| <span class="st">&quot;Greetings, creature.&quot;</span>;</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="op">}</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="pp">vial::run!</span>();</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="op">}</span></span></code></pre></div>
<p>That should tell you a lot, in that there isn’t a lot to <strong>Vial</strong>.</p>
<p>Now here’s a bigger bear, showing off more of <strong>Vial</strong>’s features:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">use</span> <span class="pp">vial::prelude::</span>*;</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="pp">routes!</span> <span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    GET <span class="st">&quot;/&quot;</span> =&gt; hello_world;</span>
<span id="cb2-5"><a href="#cb2-5"></a>    POST <span class="st">&quot;/&quot;</span> =&gt; redirect_to_greeting;</span>
<span id="cb2-6"><a href="#cb2-6"></a>    GET <span class="st">&quot;/:name&quot;</span> =&gt; hello_name;</span>
<span id="cb2-7"><a href="#cb2-7"></a>    GET <span class="st">&quot;/*path&quot;</span> =&gt; |req|</span>
<span id="cb2-8"><a href="#cb2-8"></a>      <span class="pp">Response::</span>from(<span class="dv">404</span>).with_body(</span>
<span id="cb2-9"><a href="#cb2-9"></a>        <span class="pp">format!</span>(<span class="st">&quot;&lt;h1&gt;404 Not Found: {}&lt;/h1&gt;&quot;</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>          req.arg(<span class="st">&quot;path&quot;</span>).unwrap_or(<span class="st">&quot;&quot;</span>)));</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="op">}</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="kw">fn</span> hello_world(_req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="st">&quot;&lt;h1&gt;Hello, world!&lt;/h1&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="st">    &lt;p&gt;&lt;strong&gt;What&#39;s your name?&lt;/strong&gt;&lt;/p&gt;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="st">    &lt;form method=&#39;POST&#39; action=&#39;/&#39;&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="st">        &lt;p&gt;&lt;input name=&#39;name&#39; type=&#39;text&#39;/&gt;&lt;/p&gt;</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="st">        &lt;p&gt;&lt;input type=&#39;submit&#39;/&gt;&lt;/p&gt;</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="st">    &lt;/form&gt;&quot;</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="op">}</span></span>
<span id="cb2-21"><a href="#cb2-21"></a></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="kw">fn</span> redirect_to_greeting(req: Request) -&gt; <span class="dt">Option</span>&lt;<span class="kw">impl</span> Responder&gt; <span class="op">{</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="kw">let</span> name = req.form(<span class="st">&quot;name&quot;</span>)?;</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="cn">Some</span>(<span class="pp">Response::</span>redirect_to(<span class="pp">format!</span>(<span class="st">&quot;/{}&quot;</span>, name)))</span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="op">}</span></span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="kw">fn</span> hello_name(req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="pp">format!</span>(</span>
<span id="cb2-29"><a href="#cb2-29"></a>        <span class="st">&quot;&lt;h1&gt;Why hello there, {}!&lt;/h1&gt;&quot;</span>,</span>
<span id="cb2-30"><a href="#cb2-30"></a>        req.arg(<span class="st">&quot;name&quot;</span>).unwrap()</span>
<span id="cb2-31"><a href="#cb2-31"></a>    )</span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="op">}</span></span>
<span id="cb2-33"><a href="#cb2-33"></a></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>    <span class="pp">run!</span>().unwrap();</span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="op">}</span></span></code></pre></div>
<p>You can run the above example from the root of this repository:</p>
<pre><code>$ cargo run --example manual</code></pre>
<p><strong>Vial</strong> comes with a handful of examples in the <code>examples/</code> directory, so be sure to peruse them skeptically either alongside or after digesting this manual.</p>
<h2 id="getting-started">Getting Started</h2>
<p><strong>Vial</strong> should work on any recent, stable version of <strong>Rust</strong> on <strong>Linux</strong> or <strong>macOS</strong>.</p>
<p>To begin, add <strong>Vial</strong> to your project’s <code>Cargo.toml</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb4-1"><a href="#cb4-1"></a><span class="op">[</span>dependencies<span class="op">]</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>vial = <span class="st">&quot;*&quot;</span></span></code></pre></div>
<p>Now all you have to do is call <code>vial::routes!</code> to define your routes and <code>vial::run!</code> to start the server in <code>src/main.rs</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb5-1"><a href="#cb5-1"></a><span class="pp">vial::routes!</span> <span class="op">{</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>    GET <span class="st">&quot;/&quot;</span> =&gt; |_| <span class="st">&quot;It works!&quot;</span>;</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="op">}</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="pp">vial::run!</span>();</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="op">}</span></span></code></pre></div>
<p>This should start a server at <a href="http://0.0.0.0:7667" class="uri">http://0.0.0.0:7667</a> and tell you that it did. Congratulations! You’re on your way.</p>
<h2 id="routing">Routing</h2>
<p>Routing is the real gravy and potatoes of any web framework, if you think about it. In <strong>Vial</strong>, routes are defined with the <code>routes!</code> macro in this format:</p>
<pre><code>HTTP_METHOD ROUTE_PATTERN =&gt; ACTION;</code></pre>
<p>The order in which routes are written matters - routes written first will be checked for matches first, meaning you can declare many routes that point to <code>"/"</code>, but only the first one defined will ever match.</p>
<h3 id="http-methods">HTTP Methods</h3>
<p><code>HTTP_METHOD</code> can be one of:</p>
<ul>
<li><code>GET</code></li>
<li><code>HEAD</code></li>
<li><code>POST</code></li>
<li><code>PUT</code></li>
<li><code>DELETE</code></li>
<li><code>PATCH</code></li>
</ul>
<h3 id="route-patterns">Route Patterns</h3>
<p><code>ROUTE_PATTERN</code> can be an exact match, such as <code>"/user"</code> or <code>"/v2/search.php3"</code>, or it can include a named parameter:</p>
<ol type="1">
<li><code>"/:name"</code> — This will match anything except paths with <code>/</code> or <code>.</code> in them.</li>
<li><code>"/:name.md"</code> — Use this format to match on a specific file extension.</li>
<li><code>"/*name"</code> — This will match everything, including <code>/</code> and <code>.</code></li>
</ol>
<p>In the three examples above, calling <code>request.arg("name")</code> in an <code>ACTION</code> will return <code>Some(&amp;str)</code>.</p>
<p>Note that you can have multiple parameters in the same route, as long as the “match all” pattern occurs last:</p>
<ul>
<li><code>"/:category/:id/*name"</code></li>
</ul>
<p>This route will populate <code>request.arg("category")</code>, <code>request.arg("id")</code>, and <code>request.arg("name")</code>.</p>
<h3 id="actions">Actions</h3>
<p><code>ACTIONs</code> are what routes actually route to. Your code. The app.</p>
<p>An <code>ACTION</code> can either be a closure or the name of a function:</p>
<ol type="1">
<li>Closures take the form <code>|req: Request| { code }</code> and return an <code>impl Responder</code>.</li>
<li>Functions have the signature <code>fn(Request) -&gt; impl Responder</code>, basically the same thing.</li>
</ol>
<p>Returning <code>impl Responder</code> is easy - <a href="https://docs.rs/vial/latest/vial/trait.Responder.html">Responder</a> is a <strong>Vial</strong> trait that defines a single conversion method:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">pub</span> <span class="kw">trait</span> Responder <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="kw">fn</span> to_response(<span class="kw">self</span>) -&gt; Response;</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="op">}</span></span></code></pre></div>
<p>Both <code>&amp;str</code> and <code>String</code> are <code>impl Responder</code>, as well as some other common types. Making your own is easy, too, because using the <code>Response</code> struct is easy.</p>
<h3 id="route-modules">Route Modules</h3>
<p>Routes can be defined in different modules and combined together with <code>vial::run!</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">mod</span> blog;</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw">mod</span> wiki <span class="op">{</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="pp">vial::routes!</span> <span class="op">{</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>        GET <span class="st">&quot;/wiki&quot;</span> =&gt; |_| <span class="st">&quot;This is the wiki.&quot;</span>;</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="op">}</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="op">}</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="pp">vial::routes!</span> <span class="op">{</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    GET <span class="st">&quot;/&quot;</span> =&gt; |_| <span class="st">&quot;Index page.&quot;</span>;</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="op">}</span></span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="pp">vial::run!</span>(<span class="kw">self</span>, blog, wiki);</span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="op">}</span></span></code></pre></div>
<h2 id="requests">Requests</h2>
<p>When a route matches and an <code>ACTION</code> is called, it’s passed a <a href="https://docs.rs/vial/latest/vial/struct.Request.html">Request</a> object. <code>Request</code> contains information about the request itself, as well as a number of helper methods.</p>
<h3 id="route-parameters">Route Parameters</h3>
<p>As mentioned in the <a href="#routing">Routing</a> section above, you can define parameters in a route and access their value for a given request using <code>request.arg()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">impl</span> Request <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="kw">fn</span> arg(&amp;<span class="kw">self</span>, name: &amp;<span class="dt">str</span>) -&gt; <span class="dt">Option</span>&lt;&amp;<span class="dt">str</span>&gt;;</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="op">}</span></span></code></pre></div>
<h3 id="query-parameters">Query Parameters</h3>
<p>In addition to route parameters, <strong>Vial</strong> will also parse good ol’ fashioned query string parameters for you:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">impl</span> Request <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>    <span class="kw">fn</span> query(&amp;<span class="kw">self</span>, name: &amp;<span class="dt">str</span>) -&gt; <span class="dt">Option</span>&lt;&amp;<span class="dt">str</span>&gt;;</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="op">}</span></span></code></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb11-1"><a href="#cb11-1"></a><span class="pp">vial::routes!</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>    GET <span class="st">&quot;/info&quot;</span> =&gt; |req| <span class="pp">format!</span>(</span>
<span id="cb11-3"><a href="#cb11-3"></a>        <span class="st">&quot;Version: v{}&quot;</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>        req.query(<span class="st">&quot;version&quot;</span>).unwrap_or(<span class="st">&quot;?&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>    );</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="op">}</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>    <span class="pp">vial::run!</span>();</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="op">}</span></span></code></pre></div>
<p>Running this and visiting <code>/info</code> will show:</p>
<pre><code>Version: v?</code></pre>
<p>But visiting <code>/info?version=1.0</code> will show:</p>
<pre><code>Version: v1.0</code></pre>
<h3 id="form-data">Form Data</h3>
<p>What’s the web without open ended <code>&lt;textarea&gt;s</code>? Perish the thought.</p>
<p>POST form data follows the same pattern as query and route parameters: use <code>request.form()</code> to access a form parameter:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">impl</span> Request <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="kw">fn</span> form(&amp;<span class="kw">self</span>, name: &amp;<span class="dt">str</span>) -&gt; <span class="dt">Option</span>&lt;&amp;<span class="dt">str</span>&gt;;</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="op">}</span></span></code></pre></div>
<h3 id="request-headers">Request Headers</h3>
<p>Headers are available without any of the peksy conveniences of type safety. Just give <code>request.header()</code> a string and hope you get one back!</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">impl</span> Request <span class="op">{</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="kw">fn</span> header(&amp;<span class="kw">self</span>, name: &amp;<span class="dt">str</span>) -&gt; <span class="dt">Option</span>&lt;&amp;<span class="dt">str</span>&gt;;</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="op">}</span></span></code></pre></div>
<p>Header names are case insensitive, though, so at least you don’t have to worry about that.</p>
<h3 id="other-info">Other Info</h3>
<p>Beyond the headers, <code>Request</code> also surfaces a few more basic bits of information such as the <code>request.method()</code> and <code>request.path()</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">impl</span> Request <span class="op">{</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="co">// &quot;GET&quot;, &quot;POST&quot;, etc. Always uppercase.</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="kw">fn</span> method(&amp;<span class="kw">self</span>) -&gt; &amp;<span class="dt">str</span>;</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="co">// Always starts with &quot;/&quot;</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="kw">fn</span> path(&amp;<span class="kw">self</span>) -&gt; &amp;<span class="dt">str</span>;</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="op">}</span></span></code></pre></div>
<h2 id="responses">Responses</h2>
<p>Every <code>ACTION</code> returns an <code>impl Responder</code>, which is a trait with a single method:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">pub</span> <span class="kw">trait</span> Responder <span class="op">{</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>    <span class="kw">fn</span> to_response(<span class="kw">self</span>) -&gt; Response;</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="op">}</span></span></code></pre></div>
<p>Common types like <code>&amp;str</code> and <code>Option&lt;String&gt;</code> already implement this trait, so you are free to be lazy and return simple objects in your <code>ACTIONs</code>. If, however, you want to set headers and do other fancy jazz, you’ll need to build and return a <a href="https://docs.rs/vial/latest/vial/struct.Response.html">Response</a> object directly.</p>
<p><code>Response</code> objects can be with either a body or status code:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">// Response w/ HTTP Status Code 422, No Body</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">fn</span> fourtwotwo(_req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="pp">Response::</span>from(<span class="dv">422</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="op">}</span></span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">// Response w/ HTTP Status Code 422 &amp; Body</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">fn</span> fourtwotwo(_req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="pp">Response::</span>from(<span class="st">&quot;404 File Not Found&quot;</span>).with_code(<span class="dv">404</span>);</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="op">}</span></span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">// Serve the README as HTML. Probably want to Markdownize it first...</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="kw">fn</span> fourtwotwo(_req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>    <span class="pp">Response::</span>from_file(<span class="st">&quot;README.md&quot;</span>);</span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="op">}</span></span></code></pre></div>
<h3 id="from-string">from String</h3>
<p>Each <code>Response</code> defaults to a <code>Content-Type</code> of <code>text/html; charset=utf8</code>, so you can build HTML with your bare hands and <strong>Vial</strong> will lovingly deliver it to the client:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">fn</span> index(_req: Request) -&gt; <span class="kw">impl</span> Responder <span class="op">{</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="pp">Response::</span>from(<span class="st">&quot;&lt;marquee&gt;Coming soon!&lt;/marquee&gt;&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="op">}</span></span></code></pre></div>
<h3 id="from-file">from File</h3>
<p>If you</p>
<h3 id="from-asset">from Asset</h3>
<h3 id="redirect">Redirect</h3>
<h3 id="status-codes">Status Codes</h3>
<h3 id="headers">Headers</h3>
<h2 id="assets">Assets</h2>
<h3 id="setting-asset-dir">Setting asset dir</h3>
<h3 id="assetexists"><code>asset::exists()</code></h3>
<h3 id="assetpath"><code>asset::path()</code></h3>
<h3 id="bundling-assets">Bundling Assets</h3>
<ul>
<li><code>vial::bundle_assets(path_to_asset_dir)</code></li>
</ul>
<h2 id="templates">Templates</h2>
<h3 id="hatter">Hatter</h3>
<h3 id="horrorshow">Horrorshow</h3>
<h3 id="tera">Tera</h3>
<h2 id="cookies">Cookies</h2>
<h2 id="sessions">Sessions</h2>
<h2 id="json">JSON</h2>
<h2 id="state">State</h2>
<h2 id="database">Database</h2>
<h2 id="markdown">Markdown</h2>
</main>
    <script>
      function clickHamburger() {
        let nav = document.getElementsByTagName("nav")[0];
        if (nav.className == "show-mobile") nav.className = "";
        else nav.className = "show-mobile";
      }
    </script>
  </body>
</html>
